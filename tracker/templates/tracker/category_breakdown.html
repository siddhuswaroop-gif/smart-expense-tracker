<!DOCTYPE html>
<html>
<head>
    <title>Expense Breakdown</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --bg1: #0f172a;
            --bg2: #1e293b;
            --glass: rgba(255,255,255,0.06);
            --border: rgba(255,255,255,0.18);
            --accent: #38bdf8;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
            background: radial-gradient(circle at top, var(--bg2), var(--bg1));
            color: white;
        }

        .navbar {
            background: rgba(15,23,42,0.75);
            backdrop-filter: blur(10px);
            padding: 18px 35px;
            font-size: 20px;
            font-weight: 600;
            border-bottom: 1px solid var(--border);
        }

        .container {
            padding: 30px 40px;
        }

        .btn {
            display: inline-block;
            background: linear-gradient(135deg, #4f46e5, #06b6d4);
            color: white;
            padding: 9px 16px;
            border-radius: 10px;
            text-decoration: none;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 20px;
            transition: 0.25s ease;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.35);
        }

        .layout {
            display: flex;
            gap: 28px;
            flex-wrap: wrap;
        }

        .chart-box {
            flex: 1;
            min-width: 340px;
            max-width: 480px;
            background: var(--glass);
            backdrop-filter: blur(14px);
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 20px;
        }

        table {
            flex: 1;
            min-width: 280px;
            max-width: 360px;
            border-collapse: collapse;
            background: var(--glass);
            backdrop-filter: blur(14px);
            border-radius: 18px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        th {
            text-align: left;
            padding: 14px;
            font-size: 13px;
            font-weight: 500;
            color: #cbd5f5;
            background: rgba(255,255,255,0.04);
        }

        td {
            padding: 14px;
            font-size: 13px;
            border-top: 1px solid rgba(255,255,255,0.05);
        }

        tr:hover {
            background: rgba(255,255,255,0.03);
        }

        .amount {
            color: #ef4444;
            font-weight: 600;
        }
    </style>
</head>
<body>

<div class="navbar">
    SpendWise • Expense Breakdown
</div>

<div class="container">

    <a href="/" class="btn">← Dashboard</a>

    <div class="layout">

        <div class="chart-box">
            <canvas id="expenseChart"></canvas>
        </div>

        <table>
            <tr>
                <th>Category</th>
                <th>Total Spent</th>
            </tr>

            {% for row in data %}
            <tr>
                <td>{{ row.category__name }}</td>
                <td class="amount">₹ {{ row.total }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="2">No expense data</td>
            </tr>
            {% endfor %}
        </table>

    </div>

</div>

<script>
    const labels = {{ labels|safe }};
    const totals = {{ totals|safe }};

    new Chart(document.getElementById('expenseChart'), {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: totals,
                backgroundColor: [
                    "#4f46e5",
                    "#06b6d4",
                    "#10b981",
                    "#f59e0b",
                    "#ef4444",
                    "#8b5cf6"
                ],
                borderWidth: 0
            }]
        },
        options: {
            plugins: {
                legend: {
                    position: 'right',
                    labels: { color: "white" }
                }
            }
        }
    });
</script>

</body>
</html>